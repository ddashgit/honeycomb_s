# Honeycomb: A tool to generate per component power consumed by Android app run
 
## Input
1. Timeline traces : These are the timeline traces for CPU and GPU
    1. __CPU_FREQUENCY_INPUT.TXT : CPU frequency timeline
    1. __CPU_UTILIZATION_INPUT.TXT : CPU utilization timeline
    1. __GPU_FREQUENCY_INPUT.TXT : GPU frequency timeline
    1. __GPU_UTILIZATION_ALL.TXT : GPU utilization timeline
1. screen.trace : Screen power trace
1. intial.log : The initial state of the CPU and GPU frequencies
1. current.txt : It contain the timeline, current and voltage
1. Interval.txt : A given time interval [T1, T2]
 
## Output
1. CPU power timeline in time interval [T1, T2]
1. GPU power timeline in time interval [T1, T2]
1. Camera power timeline in time interval [T1, T2]
1. Screen power timeline in time interval [T1, T2]
 
## Build
Make to generate the `honeycomb` executable.
```make
make -j $(proc)
```

## Python environement setup
The `requirements.txt` conatin all the python packages required.
```bash
pip3 install -r requirements.txt
```

## Usage
The timeline traces are used to generate the utilization for each component.
<br>Currently only CPU and GPU are supported.
 
We create a timeline snippet in which we wish to generate the power numbers.
```bash
python3 scripts/generate_raw_timeline.py interval.txt current.txt timeline.snippet
```
 
Next, we create a configuration file to feed in the timeline snippet to `honeycomb`.
The user can generate the configuration file by
```
python3 scripts/generate_config.py $PATH_TO_TIMELINE_TRACES timeline.snippet config
```
Set the $PATH_TO_TIMELINE_TRACES to the location which contains the timeline traces.
 
A sample configuration file may look like
```
cpu_frequency=__CPU_FREQUENCY_INPUT.TXT
cpu_utilization=__CPU_UTILIZATION_INPUT.TXT
gpu_frequency=__GPU_FREQUENCY_INPUT.TXT
gpu_utilization=__GPU_UTILIZATION_ALL.TXT
equations=timeline.snippet
```
The absolute path may be added for each component.

### CPU and GPU power timeline
Run `honeycomb` to generate the per component utilization.
```bash
bin/run config > utilization
```
Next we use the CPU and GPU power models to generate the per component power consumed.
```bash
python3 scripts/cpu_gpu_power_timeline.py utilization $MODEL_CPU $MODEL_GPU cpu_gpu_timeline.csv
```
Set $MODEL_CPU and $MODEL_GPU to the path for cpu and gpu power models respectively.
The file `cpu_gpu_timeline.csv` contains the CPU and GPU power timeline.
 
### Camera power timeline
The camera power can be generated by
```bash
python3 scripts/camera_timeline.py current.txt interval.txt $MODEL_CAMERA camera_timeline.csv
```
Set $MODEL_CAMERA to the path for the camera power model.
The file `camera_timeline.csv` contains the camera power timeline.

### Screen power timeline
The screen power can be generated as
```bash
python3 scripts/screen_timeline.py screen.trace current.txt interval.txt screen_timeline.csv
```
The file `screen_timeline.csv` contains the screen power timeline.
